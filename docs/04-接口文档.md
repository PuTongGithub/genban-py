# 对外接口文档

## 基础信息

- **Base URL**: `http://localhost:8000`
- **接口前缀**: `/api`

---

## 1. 获取模型列表

### 接口描述
获取所有可用的 AI 模型名称

### 请求信息

**方法**: `GET`  
**路径**: `/api/get_models`

### 请求示例

```bash
curl -X GET "http://localhost:8000/api/get_models"
```

### 响应示例

```json
["qwen3-14b", "qwen3-32b", "qwen3-max", "qwen-plus", "qwen-turbo"]
```

### 响应字段说明

| 字段 | 类型 | 说明 |
|------|------|------|
| - | `string[]` | 模型名称数组 |

---

## 2. 创建新会话

### 接口描述
创建一个新的对话会话，返回会话 ID

### 请求信息

**方法**: `GET`  
**路径**: `/api/new_session`

### 请求示例

```bash
curl -X GET "http://localhost:8000/api/new_session"
```

### 响应示例

```json
1739101234.567
```

### 响应字段说明

| 字段 | 类型 | 说明 |
|------|------|------|
| - | `float` | 会话 ID（时间戳格式） |

---

## 3. 流式对话

### 接口描述
发送消息并流式接收 AI 响应（Server-Sent Events）

### 请求信息

**方法**: `POST`  
**路径**: `/api/talk`  
**Content-Type**: `application/json`

### 请求参数

| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| sessionId | `string` | 是 | 会话 ID（通过 `/api/new_session` 获取） |
| userInput | `string` | 是 | 用户输入内容 |
| model | `string` | 是 | 模型名称（从 `/api/get_models` 获取） |

### 请求示例

```bash
curl -X POST "http://localhost:8000/api/talk" \
  -H "Content-Type: application/json" \
  -d '{
    "sessionId": "1739101234.567",
    "userInput": "你好，请介绍一下自己",
    "model": "qwen3-32b"
  }'
```

### 响应格式

**Content-Type**: `text/event-stream`

响应采用 SSE (Server-Sent Events) 格式，每个事件包含一条消息片段。

### 响应字段说明

| 字段 | 类型 | 说明 |
|------|------|------|
| role | `string` | 消息角色，固定为 `"assistant"` |
| content | `string` | AI 的回答内容增量（不包含之前的内容） |
| reasoning_content | `string` | AI 的思考过程内容增量（不包含之前的内容） |

### 注意事项

1. **增量返回**: 每条 SSE 事件的 `content` 和 `reasoning_content` 只包含新增内容，前端需要自行拼接完整内容
2. **sessionId**: 前端需要维护会话 ID，用于多轮对话上下文
3. **模型选择**: 先调用 `/get_models` 获取可用模型列表
4. **SSE 处理**: 前端需要使用 `EventSource` 或 `fetch` + `ReadableStream` 处理流式响应

---

## 错误处理

### 错误响应格式

当接口发生错误时，会返回错误信息：

```json
{
  "error": "错误描述信息"
}
```
